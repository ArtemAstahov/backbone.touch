/*!
 * backbone.touch.js v0.1
 * Copyright 2012, Raymond Julin (@nervetattoo)
 * backbone.touch.js may be freely distributed under the MIT license.
 */
(function(){var a=function(a,b){return!a||!a[b]?null:d.isFunction(a[b])?a[b]():a[b]},b=/^(\S+)\s*(.*)$/,c=this.Backbone,d=this._,e=this.document;d.extend(c.View.prototype,{_touching:!1,_touchPrevents:!0,isTouch:"ontouchstart"in e,delegateEvents:function(c){if(!c&&!(c=a(this,"events")))return;this.undelegateEvents();var e=".delegateEvents"+this.cid;d(c).each(function(a,f){d.isFunction(a)||(a=this[c[f]]);if(!a)throw new Error('Method "'+c[f]+'" does not exist');var g=f.match(b),h=g[1],i=g[2];a=d.bind(a,this),h==="click"&&this.isTouch?i!==""?(this.$el.delegate(i,"touchstart"+e,this._touchHandler),this.$el.delegate(i,"touchmove"+e,this._touchHandler),this.$el.delegate(i,"touchend"+e,{method:a},this._touchHandler)):(this.$el.bind("touchstart"+e,this._touchHandler),this.$el.bind("touchmove"+e,this._touchHandler),this.$el.bind("touchend"+e,{method:a},this._touchHandler)):(h+=e,i===""?this.$el.bind(h,a):this.$el.delegate(i,h,a))},this)},_touchHandler:function(a){switch(a.type){case"touchstart":this._touching=!0;break;case"touchmove":this._touching=!1;break;case"touchend":if(this._touching){this._touching=!1;if(this._touchPrevents){var b=a.currentTarget.tagName;if(b==="BUTTON"||b==="A")a.preventDefault(),a.stopPropagation()}a.data.method(a)}}}})}).call(this);