/*!
 * backbone.touch.js v0.1
 * Copyright 2012, Raymond Julin (@nervetattoo)
 * backbone.touch.js may be freely distributed under the MIT license.
 */
(function(){var a=function(a,b){return!a||!a[b]?null:e.isFunction(a[b])?a[b]():a[b]},b="ontouchstart"in this.document,c=/^(\S+)\s*(.*)$/,d=this.Backbone,e=this._;e.extend(d.View.prototype,{_touching:!1,_touchPrevents:!0,delegateEvents:function(d){if(!d&&!(d=a(this,"events")))return;this.undelegateEvents();var f=".delegateEvents"+this.cid;e(d).each(function(a,g){e.isFunction(a)||(a=this[d[g]]);if(!a)throw new Error('Method "'+d[g]+'" does not exist');var h=g.match(c),i=h[1],j=h[2];a=e.bind(a,this),i==="click"&&b?j!==""?(this.$el.delegate(j,"touchstart"+f,this._touchHandler),this.$el.delegate(j,"touchmove"+f,this._touchHandler),this.$el.delegate(j,"touchend"+f,{method:a},this._touchHandler)):(this.$el.bind("touchstart"+f,this._touchHandler),this.$el.bind("touchmove"+f,this._touchHandler),this.$el.bind("touchend"+f,{method:a},this._touchHandler)):(i+=f,j===""?this.$el.bind(i,a):this.$el.delegate(j,i,a))},this)},_touchHandler:function(a){switch(a.type){case"touchstart":this._touching=!0;break;case"touchmove":this._touching=!1;break;case"touchend":if(this._touching){this._touching=!1;if(this._touchPrevents){var b=a.currentTarget.tagName;if(b==="BUTTON"||b==="A")a.preventDefault(),a.stopPropagation()}a.data.method(a)}}}})}).call(this);